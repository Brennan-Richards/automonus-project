{% extends "charts/base.html" %}
{% block page_content %}

  {% if request.user.profile.has_transactions %}
  <div class="row text-center">
    <div class="col">
      <h2 class="m-5"><i class="fas fa-dollar-sign"></i> Expenditures Dashboard</h2>
    </div>
  </div>
  <nav class="col-md-2 d-none d-md-block bg-light sidebar card">
    <div class="sidebar-sticky">
      <ul class="nav flex-column">
        <li class="nav-item">
          <a class="nav-link active" href="{% url 'master_dashboard' %}">
            <i class="fas fa-brain"></i>
            Master
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'income_dashboard' %}">
            <i class="fas fa-wallet"></i>
            Income
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'expenditures_dashboard' %}">
            <i class="fas fa-dollar-sign"></i>
            Expenditures <span class="sr-only">(current)</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'liabilities_dashboard' %}">
            <i class="fas fa-file-invoice-dollar"></i>
            Liabilities
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'investments_dashboard' %}">
            <i class="fas fa-hand-holding-usd"></i>
            Investments
          </a>
        </li>
      </ul>

      <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
        <span>Expenditure Tools:</span>
      </h6>
      <ul class="nav flex-column mb-2">
        <li class="nav-item">
          <a class="nav-link" href="{% url 'bill_list' %}">
            <i class="fas fa-money-bill"></i>
            Pay Bills
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'hornescalculator_base' %}">
            <i class="far fa-calendar-check"></i>
            Create a Spending Plan
          </a>
        </li>
      </ul>
    </div>
  </nav>

  <div class="col-lg-8 text-center">
    {% if user.profile.planned_life_expenses %}
      <div class="card shadow p-4 mb-4">
                <p>Each month your living expenses cost you approximately:
                <table class="table">
                  <tr>
                    <th>Daily</th>
                    <th>Weekly</th>
                    <th>Monthly</th>
                    <th>Yearly</th>
                  </tr>
                  <tr>
                    <td>${{ total_living_expenses.daily_total }}</td>
                    <td>${{ total_living_expenses.weekly_total }}</td>
                    <td>${{ total_living_expenses.monthly_cost }}</td>
                    <td>${{ total_living_expenses.yearly_total }}</td>
                  </tr>
                </table>
                <a href="{% url 'hornescalculator_base' %}" class="btn btn-sm btn-success">Edit your spending plan</a>
            </p>
      </div>
    {% endif %}
    <div class="card shadow p-4 mb-4">
      <div id="chart_container_2" class="mt-3"></div>
      <p>Total spending this month: <b>${{ sum_transactions }}</b></p>
    </div>
    <div class="card shadow p-4 mb-4">
      <div id="chart_container_1" class="mt-3"></div>
    </div>
    <div class="card shadow p-4 mb-4">
      <table id="table" class="table table-bordered">
          <thead>
              <tr>
                  <th>Date</th>
                  <th>Transaction</th>
                  <th>Amount</th>
              </tr>
          </thead>
          <tbody>
              {% for transaction in all_transactions %}
                  <tr>
                      <td data-sort="YYYYMMDD">
                          {{ transaction.date|date:"m/d/Y" }}
                      </td>
                      <td>
                          {{ transaction.name }}
                      </td>
                      <td>
                          ${{ transaction.amount }}
                      </td>
                  </tr>
              {% endfor %}
          </tbody>
      </table>
  </div>

  </div>

{% else %}

<br>
    <p>You have not yet added an institution which is compatible with our <strong>transactions</strong> product.</p>
    <a class="btn btn-primary" href="{% url 'link_institution' %}">
        Connect A Financial Institution
    </a>
{% endif %}

{% endblock page_content %}
